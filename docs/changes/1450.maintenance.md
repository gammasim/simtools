Refactor light emission application and move logic to helper functions.
